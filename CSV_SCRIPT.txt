window.alert=function() { };
var arr=[{'symbol':'AARTIIND','type':'EQ'},{'symbol':'ABAN','type':'EQ'},{'symbol':'ABFRL','type':'EQ'},{'symbol':'ACC','type':'EQ'},{'symbol':'ADANIPOWER','type':'EQ'},{'symbol':'ADANITRANS','type':'EQ'},{'symbol':'ADFFOODS','type':'EQ'},{'symbol':'AHLUCONT','type':'EQ'},{'symbol':'AKZOINDIA','type':'EQ'},{'symbol':'ALKALI','type':'EQ'},{'symbol':'ALKYLAMINE','type':'EQ'},{'symbol':'AMARAJABAT','type':'EQ'},{'symbol':'AMBUJACEM','type':'EQ'},{'symbol':'APEX','type':'EQ'},{'symbol':'APLAPOLLO','type':'EQ'},{'symbol':'APOLLOTYRE','type':'EQ'},{'symbol':'ARVIND','type':'EQ'},{'symbol':'ASHOKA','type':'EQ'},{'symbol':'ASHOKLEY','type':'EQ'},{'symbol':'ASIANPAINT','type':'EQ'},{'symbol':'ATUL','type':'EQ'},{'symbol':'AUBANK','type':'EQ'},{'symbol':'AVANTIFEED','type':'EQ'},{'symbol':'BAJAJ-AUTO','type':'EQ'},{'symbol':'BAJAJCORP','type':'EQ'},{'symbol':'BAJAJELEC','type':'EQ'},{'symbol':'BAJAJFINSV','type':'EQ'},{'symbol':'BAJAJHIND','type':'EQ'},{'symbol':'BAJAJHLDNG','type':'EQ'},{'symbol':'BAJFINANCE','type':'EQ'},{'symbol':'BALAMINES','type':'EQ'},{'symbol':'BALKRISIND','type':'EQ'},{'symbol':'BALRAMCHIN','type':'EQ'},{'symbol':'BASF','type':'EQ'},{'symbol':'BATAINDIA','type':'EQ'},{'symbol':'BBTC','type':'EQ'},{'symbol':'BERGEPAINT','type':'EQ'},{'symbol':'BFUTILITIE','type':'EQ'},{'symbol':'BGRENERGY','type':'EQ'},{'symbol':'BHARATFIN','type':'EQ'},{'symbol':'BHUSANSTL','type':'EQ'},{'symbol':'BIRLACORPN','type':'EQ'},{'symbol':'BLUESTARCO','type':'EQ'},{'symbol':'BOMDYEING','type':'EQ'},{'symbol':'BOSCHLTD','type':'EQ'},{'symbol':'BPCL','type':'EQ'},{'symbol':'BRFL','type':'EQ'},{'symbol':'BRIGADE','type':'EQ'},{'symbol':'BRITANNIA','type':'EQ'},{'symbol':'BSE','type':'EQ'},{'symbol':'CAMLINFINE','type':'EQ'},{'symbol':'CANFINHOME','type':'EQ'},{'symbol':'CANTABIL','type':'EQ'},{'symbol':'CAPF','type':'EQ'},{'symbol':'CARERATING','type':'EQ'},{'symbol':'CASTROLIND','type':'EQ'},{'symbol':'CCL','type':'EQ'},{'symbol':'CEATLTD','type':'EQ'},{'symbol':'CENTURYPLY','type':'EQ'},{'symbol':'CENTURYTEX','type':'EQ'},{'symbol':'CERA','type':'EQ'},{'symbol':'CESC','type':'EQ'},{'symbol':'CHENNPETRO','type':'EQ'},{'symbol':'CHOLAFIN','type':'EQ'},{'symbol':'COALINDIA','type':'EQ'},{'symbol':'COFFEEDAY','type':'EQ'},{'symbol':'COLPAL','type':'EQ'},{'symbol':'CRISIL','type':'EQ'},{'symbol':'CROMPTON','type':'EQ'},{'symbol':'DAAWAT','type':'EQ'},{'symbol':'DABUR','type':'EQ'},{'symbol':'DALMIABHA','type':'EQ'},{'symbol':'DBL','type':'EQ'},{'symbol':'DBREALTY','type':'EQ'},{'symbol':'DCMSHRIRAM','type':'EQ'},{'symbol':'DEEPAKFERT','type':'EQ'},{'symbol':'DEEPAKNTR','type':'EQ'},{'symbol':'DHFL','type':'EQ'},{'symbol':'DIAMONDYD','type':'EQ'},{'symbol':'DLF','type':'EQ'},{'symbol':'DMART','type':'EQ'},{'symbol':'EDELWEISS','type':'EQ'},{'symbol':'EICHERMOT','type':'EQ'},{'symbol':'EIFFL','type':'EQ'},{'symbol':'EMAMILTD','type':'EQ'},{'symbol':'ENDURANCE','type':'EQ'},{'symbol':'ENGINERSIN','type':'EQ'},{'symbol':'EQUITAS','type':'EQ'},{'symbol':'ESCORTS','type':'EQ'},{'symbol':'EVEREADY','type':'EQ'},{'symbol':'EXCELINDUS','type':'EQ'},{'symbol':'EXIDEIND','type':'EQ'},{'symbol':'FAIRCHEM','type':'EQ'},{'symbol':'FCL','type':'EQ'},{'symbol':'FCONSUMER','type':'EQ'},{'symbol':'FEL','type':'EQ'},{'symbol':'FLFL','type':'EQ'},{'symbol':'FOSECOIND','type':'EQ'},{'symbol':'FRETAIL','type':'EQ'},{'symbol':'GAIL','type':'EQ'},{'symbol':'GEECEE','type':'EQ'},{'symbol':'GHCL','type':'EQ'},{'symbol':'GILLETTE','type':'EQ'},{'symbol':'GMDCLTD','type':'EQ'},{'symbol':'GMRINFRA','type':'EQ'},{'symbol':'GNFC','type':'EQ'},{'symbol':'GOCLCORP','type':'EQ'},{'symbol':'GODFRYPHLP','type':'EQ'},{'symbol':'GODREJCP','type':'EQ'},{'symbol':'GODREJIND','type':'EQ'},{'symbol':'GODREJPROP','type':'EQ'},{'symbol':'GREENPLY','type':'EQ'},{'symbol':'GRUH','type':'EQ'},{'symbol':'GSKCONS','type':'EQ'},{'symbol':'GSPL','type':'EQ'},{'symbol':'GUJALKALI','type':'EQ'},{'symbol':'GUJFLUORO','type':'EQ'},{'symbol':'GUJGASLTD','type':'EQ'},{'symbol':'GULFOILLUB','type':'EQ'},{'symbol':'GULPOLY','type':'EQ'},{'symbol':'HATSUN','type':'EQ'},{'symbol':'HAVELLS','type':'EQ'},{'symbol':'HCC','type':'EQ'},{'symbol':'HDFC','type':'EQ'},{'symbol':'HDIL','type':'EQ'},{'symbol':'HEIDELBERG','type':'EQ'},{'symbol':'HERITGFOOD','type':'EQ'},{'symbol':'HEROMOTOCO','type':'EQ'},{'symbol':'HIMATSEIDE','type':'EQ'},{'symbol':'HINDALCO','type':'EQ'},{'symbol':'HINDCOPPER','type':'EQ'},{'symbol':'HINDPETRO','type':'EQ'},{'symbol':'HINDUNILVR','type':'EQ'},{'symbol':'HINDZINC','type':'EQ'},{'symbol':'HSCL','type':'EQ'},{'symbol':'HSIL','type':'EQ'},{'symbol':'HUDCO','type':'EQ'},{'symbol':'IBREALEST','type':'EQ'},{'symbol':'IBULHSGFIN','type':'EQ'},{'symbol':'IBVENTURES','type':'EQ'},{'symbol':'ICICIPRULI','type':'EQ'},{'symbol':'ICIL','type':'EQ'},{'symbol':'ICRA','type':'EQ'},{'symbol':'IDFC','type':'EQ'},{'symbol':'IFBIND','type':'EQ'},{'symbol':'IFCI','type':'EQ'},{'symbol':'IGARASHI','type':'EQ'},{'symbol':'IGL','type':'EQ'},{'symbol':'IGPL','type':'EQ'},{'symbol':'IL&FSTRANS','type':'EQ'},{'symbol':'INDIACEM','type':'EQ'},{'symbol':'INDIAGLYCO','type':'EQ'},{'symbol':'IOC','type':'EQ'},{'symbol':'IRB','type':'EQ'},{'symbol':'ITC','type':'EQ'},{'symbol':'ITDCEM','type':'EQ'},{'symbol':'JAYAGROGN','type':'EQ'},{'symbol':'JBFIND','type':'EQ'},{'symbol':'JCHAC','type':'EQ'},{'symbol':'JINDALSAW','type':'EQ'},{'symbol':'JINDALSTEL','type':'EQ'},{'symbol':'JKCEMENT','type':'EQ'},{'symbol':'JKIL','type':'EQ'},{'symbol':'JKLAKSHMI','type':'EQ'},{'symbol':'JKTYRE','type':'EQ'},{'symbol':'JMFINANCIL','type':'EQ'},{'symbol':'JOCIL','type':'EQ'},{'symbol':'JPASSOCIAT','type':'EQ'},{'symbol':'JSL','type':'EQ'},{'symbol':'JSWENERGY','type':'EQ'},{'symbol':'JSWSTEEL','type':'EQ'},{'symbol':'JUBLFOOD','type':'EQ'},{'symbol':'JYOTHYLAB','type':'EQ'},{'symbol':'KAJARIACER','type':'EQ'},{'symbol':'KALPATPOWR','type':'EQ'},{'symbol':'KANORICHEM','type':'EQ'},{'symbol':'KANSAINER','type':'EQ'},{'symbol':'KEC','type':'EQ'},{'symbol':'KESORAMIND','type':'EQ'},{'symbol':'KITEX','type':'EQ'},{'symbol':'KKCL','type':'EQ'},{'symbol':'KOHINOOR','type':'EQ'},{'symbol':'KOLTEPATIL','type':'EQ'},{'symbol':'KPRMILL','type':'EQ'},{'symbol':'KRBL','type':'EQ'},{'symbol':'KSCL','type':'EQ'},{'symbol':'KWALITY','type':'EQ'},{'symbol':'L&TFH','type':'EQ'},{'symbol':'LAKSHMIEFL','type':'EQ'},{'symbol':'LICHSGFIN','type':'EQ'},{'symbol':'LINDEINDIA','type':'EQ'},{'symbol':'LT','type':'EQ'},{'symbol':'M&M','type':'EQ'},{'symbol':'M&MFIN','type':'EQ'},{'symbol':'MAGMA','type':'EQ'},{'symbol':'MANAPPURAM','type':'EQ'},{'symbol':'MANPASAND','type':'EQ'},{'symbol':'MARICO','type':'EQ'},{'symbol':'MARUTI','type':'EQ'},{'symbol':'MCDOWELL-N','type':'EQ'},{'symbol':'MCLEODRUSS','type':'EQ'},{'symbol':'MFSL','type':'EQ'},{'symbol':'MGL','type':'EQ'},{'symbol':'MINDACORP','type':'EQ'},{'symbol':'MINDAIND','type':'EQ'},{'symbol':'MOIL','type':'EQ'},{'symbol':'MOTHERSUMI','type':'EQ'},{'symbol':'MOTILALOFS','type':'EQ'},{'symbol':'MRF','type':'EQ'},{'symbol':'MRPL','type':'EQ'},{'symbol':'MUTHOOTFIN','type':'EQ'},{'symbol':'NATIONALUM','type':'EQ'},{'symbol':'NAVINFLUOR','type':'EQ'},{'symbol':'NBCC','type':'EQ'},{'symbol':'NBVENTURES','type':'EQ'},{'symbol':'NCC','type':'EQ'},{'symbol':'NESTLEIND','type':'EQ'},{'symbol':'NHPC','type':'EQ'},{'symbol':'NLCINDIA','type':'EQ'},{'symbol':'NMDC','type':'EQ'},{'symbol':'NTPC','type':'EQ'},{'symbol':'OBEROIRLTY','type':'EQ'},{'symbol':'OCCL','type':'EQ'},{'symbol':'OIL','type':'EQ'},{'symbol':'OMAXE','type':'EQ'},{'symbol':'OMKARCHEM','type':'EQ'},{'symbol':'ONGC','type':'EQ'},{'symbol':'ORIENTCEM','type':'EQ'},{'symbol':'PAGEIND','type':'EQ'},{'symbol':'PANAMAPET','type':'EQ'},{'symbol':'PARAGMILK','type':'EQ'},{'symbol':'PCJEWELLER','type':'EQ'},{'symbol':'PETRONET','type':'EQ'},{'symbol':'PFC','type':'EQ'},{'symbol':'PFS','type':'EQ'},{'symbol':'PGHH','type':'EQ'},{'symbol':'PHILIPCARB','type':'EQ'},{'symbol':'PHOENIXLTD','type':'EQ'},{'symbol':'PIDILITIND','type':'EQ'},{'symbol':'PNBHOUSING','type':'EQ'},{'symbol':'PNCINFRA','type':'EQ'},{'symbol':'POWERGRID','type':'EQ'},{'symbol':'PRABHAT','type':'EQ'},{'symbol':'PREMEXPLN','type':'EQ'},{'symbol':'PRESTIGE','type':'EQ'},{'symbol':'PRISMCEM','type':'EQ'},{'symbol':'PROVOGE','type':'EQ'},{'symbol':'PTC','type':'EQ'},{'symbol':'PUNJABCHEM','type':'EQ'},{'symbol':'RADICO','type':'EQ'},{'symbol':'RAIN','type':'EQ'},{'symbol':'RAJESHEXPO','type':'EQ'},{'symbol':'RAMCOCEM','type':'EQ'},{'symbol':'RAYMOND','type':'EQ'},{'symbol':'RECLTD','type':'EQ'},{'symbol':'REFEX','type':'EQ'},{'symbol':'RELAXO','type':'EQ'},{'symbol':'RELIANCE','type':'EQ'},{'symbol':'RELIGARE','type':'EQ'},{'symbol':'RELINFRA','type':'EQ'},{'symbol':'RENUKA','type':'EQ'},{'symbol':'REPCOHOME','type':'EQ'},{'symbol':'RPOWER','type':'EQ'},{'symbol':'RTNPOWER','type':'EQ'},{'symbol':'SADBHAV','type':'EQ'},{'symbol':'SAIL','type':'EQ'},{'symbol':'SFL','type':'EQ'},{'symbol':'SHK','type':'EQ'},{'symbol':'SHOPERSTOP','type':'EQ'},{'symbol':'SHREECEM','type':'EQ'},{'symbol':'SHREEPUSHK','type':'EQ'},{'symbol':'SHRIRAMCIT','type':'EQ'},{'symbol':'SIL','type':'EQ'},{'symbol':'SITASHREE','type':'EQ'},{'symbol':'SJVN','type':'EQ'},{'symbol':'SKMEGGPROD','type':'EQ'},{'symbol':'SKML','type':'EQ'},{'symbol':'SMLISUZU','type':'EQ'},{'symbol':'SOBHA','type':'EQ'},{'symbol':'SOLARINDS','type':'EQ'},{'symbol':'SOMANYCERA','type':'EQ'},{'symbol':'SREINFRA','type':'EQ'},{'symbol':'SRF','type':'EQ'},{'symbol':'SRHHYPOLTD','type':'EQ'},{'symbol':'SRTRANSFIN','type':'EQ'},{'symbol':'SUDARSCHEM','type':'EQ'},{'symbol':'SUNDRMFAST','type':'EQ'},{'symbol':'SUNTECK','type':'EQ'},{'symbol':'SUPPETRO','type':'EQ'},{'symbol':'SUPRAJIT','type':'EQ'},{'symbol':'SWANENERGY','type':'EQ'},{'symbol':'SYMPHONY','type':'EQ'},{'symbol':'TASTYBITE','type':'EQ'},{'symbol':'TATACHEM','type':'EQ'},{'symbol':'TATACOFFEE','type':'EQ'},{'symbol':'TATAGLOBAL','type':'EQ'},{'symbol':'TATAINVEST','type':'EQ'},{'symbol':'TATAMOTORS','type':'EQ'},{'symbol':'TATAMTRDVR','type':'EQ'},{'symbol':'TATAPOWER','type':'EQ'},{'symbol':'TATASPONGE','type':'EQ'},{'symbol':'TATASTEEL','type':'EQ'},{'symbol':'TECHNO','type':'EQ'},{'symbol':'TIRUMALCHM','type':'EQ'},{'symbol':'TITAN','type':'EQ'},{'symbol':'TMRVL','type':'EQ'},{'symbol':'TORNTPOWER','type':'EQ'},{'symbol':'TRENT','type':'EQ'},{'symbol':'TRIDENT','type':'EQ'},{'symbol':'TTKPRESTIG','type':'EQ'},{'symbol':'TVSMOTOR','type':'EQ'},{'symbol':'TVSSRICHAK','type':'EQ'},{'symbol':'UBL','type':'EQ'},{'symbol':'UJJIVAN','type':'EQ'},{'symbol':'ULTRACEMCO','type':'EQ'},{'symbol':'UMANGDAIRY','type':'EQ'},{'symbol':'UNITECH','type':'EQ'},{'symbol':'UPL','type':'EQ'},{'symbol':'USHERAGRO','type':'EQ'},{'symbol':'V2RETAIL','type':'EQ'},{'symbol':'VADILALIND','type':'EQ'},{'symbol':'VBL','type':'EQ'},{'symbol':'VEDL','type':'EQ'},{'symbol':'VIDEOIND','type':'EQ'},{'symbol':'VIKASECO','type':'EQ'},{'symbol':'VINATIORGA','type':'EQ'},{'symbol':'VINYLINDIA','type':'EQ'},{'symbol':'VIPIND','type':'EQ'},{'symbol':'VISHNU','type':'EQ'},{'symbol':'VMART','type':'EQ'},{'symbol':'VOLTAS','type':'EQ'},{'symbol':'VSCL','type':'EQ'},{'symbol':'VTL','type':'EQ'},{'symbol':'WABCOINDIA','type':'EQ'},{'symbol':'WELCORP','type':'EQ'},{'symbol':'WELSPUNIND','type':'EQ'},{'symbol':'WHIRLPOOL','type':'EQ'}];
var p={ 'data_type': 'priceVolume','period_type': '','date_range': 'week','from_date': '','to_date': '' };
p.data_type='priceVolume';p.date_range='week';p.period_type='DP';p.from_date='14-04-2018';p.to_date='30-04-2018';
$('#dataType').val(p.data_type);
switch(p.period_type) {
	case 'DP':
		if($('#rdDateToDate')[0]) {
			$('#rdDateToDate')[0].checked=true;
		}
		$('#fromDate').val(p.from_date);
		$('#toDate').val(p.to_date);
		break;
	default:
		if($('#rdPeriod')[0]) {
			$('#rdPeriod')[0].checked=true;
		}
		break;
}
$('#dateRange').val(p.date_range);
var $log=$("#download_log");
var $error=$("#download_error");
if(!$log[0]) {
	var html='';
	html+="<div id='download_log' style='position:absolute;top:5px;left:5px;width:420px;background:#fff;color:333;z-index:9999;font-size:18px;font-family:Calibri,Arial,Helvetica,sans-serif;'></div>";
	html+="<div id='download_error' style='position:absolute;top:5px;right:5px;width:200px;background:#fff;color:333;z-index:9999;font-size:18px;font-family:Calibri,Arial,Helvetica,sans-serif;'><ol style='padding:0;margin:0;'></ol></div>";
	$('body').append(html);
	$log=$("#download_log");
	$error=$("#download_error > ol");
}
var index=-1;
var checkCSVCount=0;
function doDownload() {
	index+=1;
	if(index<arr.length) {
		$log.html('');
		$log.html($log.html()+'index='+(index+1)+',arr.length='+arr.length+'<br/>');
		var d=arr[index];
		var symbol=d.symbol;
		var type=d.type;
		if(d.type==''){
			d.type='EQ';
		}
		if(d.type!='') {
			$('#series').val(d.type);
		}
		$('#symbol').val(symbol);
		$log.html($log.html()+'symbol='+symbol+',type='+type+'<br/>');
		var $csvFileName=$('#csvFileName');
		$csvFileName.val('');
		$('.getdata-button').click();
		checkCSVContent(symbol);
	} else {
		$log.html($log.html()+"<h1 style='font-size:40px;margin:5px 0;font-weight:normal;'>Completed</h1><br/>");
	}
}
function checkCSVContent(symbol) {
	setTimeout(function() {
		try {
			checkCSVCount+=1;
			var $csvFileName=$('#csvFileName');
			var $csvContentDiv=$('#csvContentDiv');

			var isDone=false;
			var fileName='';
			var csv='';
			if($csvFileName[0]) {
				if($csvFileName.val()!='') {
					fileName=$csvFileName.val();
					csv=$csvContentDiv.html();
				}
			}
			if(csv!='') {
				csv=csv.replace(/:/g,"\n");
				var csvFile;
				var downloadLink;
				csvFile=new Blob([csv],{
					type: "text/csv"
				});
				downloadLink=document.createElement("a");
				downloadLink.download=fileName;
				downloadLink.href=window.URL.createObjectURL(csvFile);
				downloadLink.style.display="none";
				document.body.appendChild(downloadLink);
				downloadLink.click();
				isDone=true;
				checkCSVCount=0;
			}
			$log.html($log.html()+'check='+checkCSVCount+',fileName='+fileName+'<br/>');
			if(isDone==true) {
				doDownload();
			} else {
				if(checkCSVCount<=3){
					arr[index].type='ALL';
					index=index-1;
					doDownload();
				} else {
					checkCSVCount=0;
					$error.append("<li style='margin:5px 0;list-style-type:number;'>"+symbol+"</li>");
					doDownload();
				}
			}
		} catch(e) {
			checkCSVCount=0;
			$error.append("<li style='margin:5px 0;color:red;list-style-type:number;'>Exception:"+e+"</li>");
		}
	},5000);
}
doDownload();