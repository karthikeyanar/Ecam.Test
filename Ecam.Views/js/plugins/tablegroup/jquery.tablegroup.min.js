(function(a){a.addGroup=function(c,g){if(c.grid)return!1;g=a.extend({onComplete:null},g);var b={gDiv:null,groToggler:null,init:function(){b.gDiv=a("<div class='gro-gdiv'></div>");b.groToggler=a("<div class='gro-toggler'><a href='javascript:;' data-toggle='dropdown' role='button'><i class='fa fa-caret-down'></i></a></div>");var d=a("<ul class='dropdown-menu dropdown-menu-right' role='menu' aria-labelledby='dLabel'></ul>");b.groToggler.append(d);d.append("<li role='presentation' class='dropdown-header'>Group By</li>");
var m=a("<li class='gro-clear' role='presentation'></li>"),e=a("<a href='javascript:;'>None</a>");m.append(e);d.append(m);a(b.gDiv).append(b.groToggler);a(c).before(b.gDiv);b.gDiv.append(c);var p=a("thead",c),f=a("tbody",c);f.hover(function(){b.groToggler.removeClass("open").hide()});b.gDiv.hover(function(){},function(){b.groToggler.removeClass("open").hide()});e.addClass("select");e.unbind("click").click(function(){a("tr > th",p).show();a(".grow",f).remove();a("li > a",d).removeClass("select");e.addClass("select");
a("tr",f).show()});a("tr > th",c).each(function(e){var k=a(this);k.attr("ci",e);if("true"!=k.attr("sum")){e=a("<li role='presentation'></li>");var l=a("<a href='javascript:;'><i class='fa fa-check'></i>"+k.attr("displayname")+"</a>");e.append(l);d.append(e);l.unbind("click").click(function(){b.gDiv.addClass("gro-applied");a("li > a",d).removeClass("select");l.addClass("select");a(c).addClass("apply-group");a(".grow",f).remove();a("tr",f).hide();a("tr > th",c).each(function(){var b=a(this);b.attr("displayname")!=
k.attr("displayname")&&"true"!=b.attr("sum")?b.hide():b.show()});var e=[];a("tr > th:not([sum='true']):visible",c).each(function(){var b=a(this).attr("ci");a("tr:not(.grow)",f).each(function(){var d={key:"",index:b,sums:[]},q=a("td:eq("+b+")",this).html();d.key=q;var n=!1;a(e).each(function(a,b){d.key==b.key&&(n=!0)});0==n&&(e.push(d),a("tr:not(.grow)",f).each(function(){var e=a(this);a("td:eq("+b+")",this).html()==d.key&&a("tr > th[sum='true']:visible",c).each(function(){var b=a(this).attr("ci"),
c=cFloat(a("td:eq("+b+")",e).html()),h=null;a.each(d.sums,function(a,d){d.index==b&&(h=d)});null==h?(h={index:b,value:c},d.sums.push(h)):h.value+=cFloat(c)})}))});var d=[];a.each(e,function(b,c){var e=[],f=[];e.push(cInt(c.index));a.each(c.sums,function(a,b){e.push(cInt(b.index))});var g=e.sort(function(a,b){return a-b});a.each(g,function(b,d){cInt(c.index)==d?f.push({value:c.key,iskeycol:"true"}):a.each(c.sums,function(a,b){cInt(b.index)==d&&f.push({value:b.value,iskeycol:"false"})})});d.push(f)});
a.each(d,function(b,d){var c=a("<tr></tr>");a.each(d,function(a,b){c.append("<td class='"+("true"==b.iskeycol?"gro-key-col":"gro-sum-col")+"'><div>"+b.value+"</div></td>")});c.addClass("grow");f.append(c)})});b.groToggler.removeClass("open").hide();if(g.onComplete)g.onComplete()})}a(this).hover(function(){var c=a(this).position().left+a(this).outerWidth(!0)-a(b.groToggler).outerWidth(!0);d.removeClass("dropdown-menu-right").removeClass("dropdown-menu-left");b.gDiv.offset().left<c?d.addClass("dropdown-menu-right"):
d.addClass("dropdown-menu-left");b.groToggler.css({top:0,left:c,display:"block"})},function(){})})}};b.init();c.grid=b;return c};a(document).ready(function(){});a.fn.tableGroup=function(c){return this.each(function(){a.addGroup(this,c)})}})(jQuery);
